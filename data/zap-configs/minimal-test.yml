# ZAP DAST Scanner - Minimal Test Configuration
# Schema: https://raw.githubusercontent.com/huntridge-labs/hardening-workflows/main/.github/schemas/zap-config.schema.json
#
# Target-friendly: Only 3 scans, one reliable external target, one self-contained
# Sequential scan_groups prevent artifact collisions

defaults:
  max_duration_minutes: 5
  fail_on_severity: none
  allow_failure: true
  post_pr_comment: false

scan_groups:
  # Group 1: URL-based scans (single reliable target)
  - name: url-scans
    description: URL Mode Tests
    target:
      mode: url
    scans:
      - name: url-baseline
        type: baseline
        target_url: http://demo.testfire.net

      - name: threshold-test
        type: baseline
        target_url: http://demo.testfire.net
        fail_on_severity: high
        allow_failure: true

  # Group 2: Docker-based scan (self-contained, no external load)
  - name: docker-scans
    description: Docker Mode Test
    target:
      mode: docker-run
      image: ghcr.io/stefanprodan/podinfo:latest
      ports: "9898:9898"
    scans:
      - name: docker-baseline
        type: baseline
        target_url: http://localhost:9898
