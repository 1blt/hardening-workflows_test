# ZAP Reliable Test Suite - Self-Hosted Targets
#
# Strategy: Use Docker containers for reliability + accuracy
# - juice-shop: Known OWASP vulnerabilities (XSS, SQLi, etc.)
# - podinfo: Clean app (should have minimal findings)
# - External URL: Only for "real world" sanity check
#
# Expected Results:
# - juice-shop scans: Should find HIGH severity vulns
# - podinfo scan: Should find NONE/LOW only
# - threshold tests: Should behave predictably

target:
  mode: docker-run
  image: bkimminich/juice-shop:latest
  ports: "3000:3000"

scans:
  # Test 1: Baseline scan - should find vulns
  - name: juice-baseline
    type: baseline
    target_url: http://localhost:3000
    fail_on_severity: none
    allow_failure: true
    max_duration_minutes: 3

  # Test 2: Full scan - should find more vulns
  - name: juice-full
    type: full
    target_url: http://localhost:3000
    fail_on_severity: none
    allow_failure: true
    max_duration_minutes: 8

  # Test 3: Threshold high - should PASS (allow_failure=true)
  - name: threshold-high
    type: baseline
    target_url: http://localhost:3000
    fail_on_severity: high
    allow_failure: true
    max_duration_minutes: 2

  # Test 4: Threshold medium - should find medium+ vulns
  - name: threshold-medium
    type: baseline
    target_url: http://localhost:3000
    fail_on_severity: medium
    allow_failure: true
    max_duration_minutes: 2
