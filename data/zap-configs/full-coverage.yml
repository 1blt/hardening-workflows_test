# Full Coverage ZAP Test - Single Config
#
# Strategy: Maximize coverage, minimize external pings
# - 6 tests use self-hosted Docker containers
# - 1 test uses external URL (validates URL mode works)
#
# Coverage:
# - Scan types: baseline, full
# - Thresholds: none, medium, high
# - Targets: vulnerable app, clean app, external URL
# - Modes: docker-run (6), url (1)

target:
  mode: docker-run
  image: bkimminich/juice-shop:latest
  ports: "3000:3000"

scans:
  # === JUICE-SHOP (vulnerable app) ===

  # Test 1: Baseline scan - basic spider + passive scan
  - name: baseline-scan
    type: baseline
    target_url: http://localhost:3000
    fail_on_severity: none
    allow_failure: true
    max_duration_minutes: 3

  # Test 2: Full scan - active scanning (finds more vulns)
  - name: full-scan
    type: full
    target_url: http://localhost:3000
    fail_on_severity: none
    allow_failure: true
    max_duration_minutes: 8

  # Test 3: Threshold HIGH - should pass (only fails on high severity)
  - name: threshold-high
    type: baseline
    target_url: http://localhost:3000
    fail_on_severity: high
    allow_failure: true
    max_duration_minutes: 2

  # Test 4: Threshold MEDIUM - validates threshold enforcement
  - name: threshold-medium
    type: baseline
    target_url: http://localhost:3000
    fail_on_severity: medium
    allow_failure: true
    max_duration_minutes: 2
